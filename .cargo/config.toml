[env]
# CUDA 13.0 installation path
CUDA_PATH = "/usr/local/cuda-13.0"
CUDA_HOME = "/usr/local/cuda-13.0"
CUDACXX = "/usr/local/cuda-13.0/bin/nvcc"

# Clang binding arguments for CUDA
BINDGEN_EXTRA_CLANG_ARGS = "-I/usr/lib/gcc/x86_64-linux-gnu/14/include -I/usr/include/x86_64-linux-gnu -I/usr/include"

# Note: rustg-specific environment variables moved to build scripts
# When using cargo-g, set these environment variables:
# export RUSTG_ENABLE_GPU_COMPILATION=true
# export RUSTG_CUDA_PATH=/usr/local/cuda-13.0
# export RUSTG_GPU_MEMORY_MODEL=distributed
# export RUSTG_OPTIMIZATION_LEVEL=3
# export RUSTG_TARGET_CAPABILITY=8.9

# ===========================================
# CPU Target Optimization Flags (from parallel programming lecture)
# Enable native CPU features for maximum performance
# ===========================================

[build]
# Enable native CPU features (AVX2, etc.) for local development builds
# Comment this out for cross-compilation or distribution builds
rustflags = ["-C", "target-cpu=native"]

# Linux x86_64: Enable AVX2 SIMD instructions + mold linker
[target.x86_64-unknown-linux-gnu]
linker = "clang"
rustflags = ["-C", "target-cpu=native", "-C", "target-feature=+avx2", "-C", "link-arg=-fuse-ld=mold"]

# Linux aarch64: Native ARM optimizations
[target.aarch64-unknown-linux-gnu]
rustflags = ["-C", "target-cpu=native"]

# macOS Apple Silicon: Native ARM optimizations
[target.aarch64-apple-darwin]
rustflags = ["-C", "target-cpu=native"]

# macOS Intel: Enable AVX2
[target.x86_64-apple-darwin]
rustflags = ["-C", "target-cpu=native", "-C", "target-feature=+avx2"]

# ===== Kellnr Registry Proxy =====
[registries.kellnr]
index = "sparse+https://crates.lan/api/v1/crates/"

[source.crates-io]
replace-with = "kellnr-proxy"

[source.kellnr-proxy]
registry = "sparse+https://crates.lan/api/v1/cratesio/"
